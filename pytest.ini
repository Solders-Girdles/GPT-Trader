[pytest]
# Python path configuration
pythonpath = src

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
norecursedirs = archived scripts

# Output and reporting
addopts =
    --verbose
    --tb=short
    --strict-config
    --strict-markers
    --durations=10
    --maxfail=10
    -p no:warnings
    -m "not integration and not real_api and not uses_mock_broker"

# Minimum version
minversion = 7.0

markers =
    endpoints: Coinbase API endpoint tests (paths/params/modes/errors)
    perf: Performance benchmarks (opt-in)
    performance: Performance benchmarks (alias to perf)
    integration: Integration-level tests (skipped by default)
    perps: Perpetual futures trading tests
    real_api: Tests that hit real Coinbase APIs (opt-in)
    uses_mock_broker: Tests that depend on the deterministic broker (legacy MockBroker path; skipped by default)
    asyncio: Async tests (mapped to anyio via anyio plugin)
    brokerages: Brokerage adapter tests (REST/websocket contracts, error handling)
    monitoring: Monitoring system tests (alerts, metrics, evaluators, guards)
    orchestration: Orchestration layer tests (bot lifecycle, workflow, failure recovery)
    state_management: State management tests (backup, recovery, persistence)
    security: Security and auth tests (credentials, validation, encryption)
    high_impact: High-impact tests that must pass (auto-runs in CI)
    characterization: Behavior-preserving tests for refactoring (documents current behavior)
    slow: Slow tests (>1s runtime, opt-in)
