/* Main Stylesheet - GPT-Trader TUI
 *
 * Theme: Claude Code-inspired warm, editorial aesthetic
 * Palette: Rust-orange accent (#C15F3C) with warm browns and parchment tones
 *
 * This stylesheet combines all TUI styling modules:
 * 1. Theme variables (colors and spacing)
 * 2. Layout structure
 * 3. Core components
 * 4. Widget-specific styles
 * 5. Animations and transitions
 */

/* ========================================================================== */
/* THEME VARIABLES - Claude Code Palette                                     */
/* ========================================================================== */

/* === Backgrounds === */
$bg-primary: #1A1815;      /* Deep warm brown "coffee stain" - main background */
$bg-secondary: #2A2520;    /* CHANGED: Lighter warm brown - containers (was #2E2922) */
$bg-elevated: #3D3833;     /* CHANGED: Elevated surfaces (was #3A3530) */

/* === Accents === */
$accent: #D4744F;          /* CHANGED: Brighter rust-orange (was #C15F3C) */
$accent-hover: #E08A6A;    /* CHANGED: Lighter rust - hover states (was #D17A5A) */
$accent-muted: #9B5338;    /* CHANGED: Darker rust (was #8B4428) */

/* === Text Colors === */
$text-primary: #F0EDE9;    /* CHANGED: Increased brightness (was #E8E6E3) */
$text-secondary: #B8B5B2;  /* CHANGED: Increased contrast (was #ABA8A5) */
$text-muted: #7A7672;      /* CHANGED: Slightly lighter (was #6B6865) */

/* === Semantic Colors === */
$success: #85B77F;         /* CHANGED: Brighter green (was #7AA874) */
$warning: #E0B366;         /* CHANGED: More vibrant amber (was #D8A657) */
$error: #E08580;           /* CHANGED: Brighter coral-red (was #D4736E) */
$info: #7FB8D4;            /* CHANGED: Brighter blue-grey (was #6FA8C4) */

/* === Borders === */
$border-subtle: #3D3833;   /* CHANGED: Match bg-elevated (was #3A3530) */
$border-emphasis: #544F49; /* CHANGED: More contrast (was #4A453F) */

/* === Spacing Scale === */
$spacing-xs: 1;            /* Extra small spacing - tight elements */
$spacing-sm: 2;            /* Small spacing - compact layouts */
$spacing-md: 3;            /* Medium spacing - standard padding */
$spacing-lg: 4;            /* Large spacing - generous padding */

/* ========================================================================== */
/* LAYOUT PATTERNS                                                            */
/* ========================================================================== */

/* === Global Layout === */

Screen {
    layout: vertical;
    background: $bg-primary;
    color: $text-primary;
}

Label {
    color: $text-primary;
}

/* === Main Workspace - Now horizontal split (30/70) === */

#main-workspace {
    layout: horizontal;  /* Changed from vertical */
    height: 100%;
}

/* === Left Column: Market + Strategy (30% width) === */

#market-strategy-column {
    width: 30%;
    height: 100%;
    layout: vertical;
    border-right: solid $border-subtle;  /* CHANGED from wide to solid */
}

#dash-market {
    height: 50%;
}

#dash-strategy {
    height: 50%;
}

/* === Right Column: Execution + Monitoring (70% width) === */

#execution-monitoring-column {
    width: 70%;
    height: 100%;
    layout: vertical;
}

#dash-positions {
    height: 40%;  /* LARGEST - Priority #1 (28% of total screen) */
}

#dash-orders {
    height: 20%;
}

#dash-trades {
    height: 20%;
}

/* === Monitoring Row (20% of right column) === */

#monitoring-row {
    height: 20%;
    layout: vertical;
}

#system-account-row {
    height: 50%;  /* Top half of monitoring row */
    layout: horizontal;
}

#dash-system {
    width: 50%;
    height: 100%;
}

#dash-account {
    width: 50%;
    height: 100%;
}

#dash-logs {
    width: 100%;
    height: 50%;  /* Bottom half of monitoring row */
}

/* === Dashboard Items === */

.dashboard-item {
    layout: vertical;
    height: 1fr;
    border: none;                      /* REMOVED: full border */
    border-top: solid $border-subtle;  /* Only top border for separation */
    background: $bg-secondary;
    padding: 0;  /* Remove padding to prevent header clipping */
    margin: 0;   /* REMOVED: horizontal margin */
}

.dashboard-item-elevated {
    background: $bg-elevated;
}

/* === Compact Logs Styling === */

.compact-logs {
    /* Compressed log display in monitoring row */
}

.log-expand-hint {
    color: $text-muted;
    text-style: italic;
    text-align: center;
    padding: 0 $spacing-xs;
}

/* === Panel Style === */

.panel {
    background: $bg-secondary;
    border: round $border-subtle;
    padding: $spacing-md;
    margin: $spacing-xs;
}

/* ========================================================================== */
/* CORE COMPONENT STYLES                                                      */
/* ========================================================================== */

/* === Headers & Footers === */

Header {
    dock: top;
    height: 1;
    background: $bg-secondary;
    color: $text-primary;
}

Footer {
    dock: bottom;
    height: 1;
    background: $bg-secondary;
    color: $text-primary;
}

/* === Widget Headers === */

.header {
    color: $text-primary;              /* Light warm grey for contrast */
    text-style: normal;                /* CHANGED from bold - reduce emphasis */
    text-align: left;                  /* Left-aligned editorial style */
    background: $bg-elevated;          /* CHANGED from $accent-muted - subtler */
    padding: 0 2;                      /* Compact horizontal padding */
    border-left: none;                 /* REMOVED: accent left border */
    border-bottom: none;               /* REMOVED: accent bottom border */
    height: 1;                         /* CHANGED from auto - single line */
    content-align: left middle;        /* Vertically center the text */
}

.header-icon {
    color: $accent;
    margin-right: $spacing-xs;
}

/* === Buttons === */

Button {
    min-width: 12;
    height: 3;
    margin: 0 $spacing-xs;
    border: solid $border-emphasis;
    padding: 0 $spacing-md;
    background: $bg-elevated;
    color: $text-primary;
    text-style: bold;
}

Button:hover {
    border: solid $accent;
    background: $accent-muted;
    color: $text-primary;
}

Button:focus {
    border: solid $accent;
    background: $accent;
    color: $bg-primary;
}

Button.-disabled {
    opacity: 0.5;
    color: $text-muted;
    border: solid $border-subtle;
}

/* === Control Buttons (Start/Stop) === */

#start-btn {
    background: $success;
    color: $bg-primary;
    border-left: wide $success;
}

#start-btn:hover {
    background: $success;
    color: $bg-primary;
    border: solid $success;
    text-style: bold;
}

#stop-btn {
    background: $error;
    color: $bg-primary;
    border-left: wide $error;
}

#stop-btn:hover {
    background: $error;
    color: $bg-primary;
    border: solid $error;
    text-style: bold;
}

/* === DataTable === */

DataTable {
    background: $bg-primary;
    color: $text-primary;
    border: none;
    padding: 0 1;                  /* REDUCED from $spacing-md - tighter padding */
    /* height controlled by individual widgets via DEFAULT_CSS */
}

DataTable > .datatable--header {
    background: $bg-elevated;
    color: $text-secondary;        /* CHANGED from $accent - less emphasis */
    text-style: normal;            /* CHANGED from bold - reduce weight */
    padding: $spacing-xs $spacing-md;
    border-bottom: solid $border-subtle;  /* CHANGED from $accent-muted */
}

DataTable > .datatable--cursor {
    background: $accent-muted;
    color: $text-primary;
    text-style: bold;
}

DataTable > .datatable--odd-row {
    background: $bg-primary;
}

DataTable > .datatable--even-row {
    background: rgba(58, 53, 48, 0.15);  /* CHANGED to 0.15 - more subtle zebra striping */
}

DataTable:focus > .datatable--cursor {
    background: $accent;
    color: $bg-primary;
    text-style: bold;
}

/* Row hover effect */
DataTable > .datatable--hover {
    background: rgba(193, 95, 60, 0.15);  /* Subtle accent tint on hover */
}

/* === Tabs === */

Tabs {
    background: $bg-secondary;
    color: $text-primary;
    dock: top;
    height: 3;
}

Tab {
    padding: $spacing-xs $spacing-md;
}

Tab.-active {
    background: $bg-elevated;
    color: $accent;
    text-style: bold;
    border-bottom: solid $accent;
}

/* === Content Areas === */

ContentSwitcher {
    background: $bg-primary;
    height: 1fr;
}

#dashboard-container, #market-container, #positions-container, #system-container {
    padding: $spacing-xs;
    height: 1fr;
}

/* === Empty States === */

.empty-state {
    color: $text-muted;
    text-style: italic;
    text-align: center;
    padding: $spacing-lg $spacing-md;
    background: rgba(58, 53, 48, 0.2);
    border: dashed $border-subtle;
    margin: $spacing-md;
    height: auto;
    display: none;  /* Hidden by default */
}

.empty-state-icon {
    color: $accent;
    text-style: bold;
    margin-bottom: $spacing-xs;
}

.empty-state-title {
    color: $text-secondary;
    text-style: bold;
}

.empty-state-hint {
    color: $text-muted;
    text-style: italic;
    margin-top: $spacing-xs;
}

/* === Log Widget === */

Log {
    background: $bg-secondary;
    color: $text-primary;
    border: solid $border-subtle;
    padding: 0 $spacing-xs;
}

/* === Typography Utilities === */

.text-success { color: $success; }
.text-error { color: $error; }
.text-warning { color: $warning; }
.text-info { color: $info; }
.text-muted { color: $text-muted; }

.bold { text-style: bold; }

/* === Accessibility === */

/* Focus indicators for keyboard navigation */
*:focus {
    border: solid $accent;
    outline: solid $accent;
}

Button:focus, DataTable:focus {
    border: double $accent;
}

/* ========================================================================== */
/* WIDGET-SPECIFIC STYLES                                                     */
/* ========================================================================== */

/* === Status Bar (BotStatusWidget) === */

#bot-status-header {
    dock: top;
    height: 6;                     /* Taller for prominence */
    background: $bg-secondary;
    color: $text-primary;
    border-bottom: double $accent;  /* Double border for emphasis */
    padding: 0;
}

#status-bar-container {
    height: 100%;
    align-vertical: middle;
}

.status-section {
    padding: 0 $spacing-md;
    height: 100%;
    align-vertical: middle;
}

#bot-controls {
    width: auto;
    border-right: solid $border-subtle;
}

#status-info {
    width: 1fr;
    border-right: solid $border-subtle;
}

#performance-metrics {
    width: auto;
}

.status-row {
    height: auto;
    align-vertical: middle;
    margin-bottom: 0;
}

/* === Status Labels & Values === */

.status-label {
    color: $text-secondary;
    text-style: bold;
    margin-right: $spacing-xs;
}

.status-value {
    color: $text-primary;
    text-style: bold;
    margin-right: $spacing-md;
    background: $bg-elevated;
    padding: 0 $spacing-md;
    border: solid $border-subtle;
}

.status-running {
    color: $success;
    background: rgba(122, 168, 116, 0.2);
    padding: 0 $spacing-md;
    border: solid $success;
}

.status-stopped {
    color: $error;
    background: rgba(212, 115, 110, 0.2);
    padding: 0 $spacing-md;
    border: solid $error;
}

/* === Heartbeat Indicator === */

.heartbeat-pulse {
    margin-left: $spacing-xs;
}

.heartbeat-bright {
    color: $success;
    text-style: bold;
}

.heartbeat-dim {
    color: $text-muted;
}

/* === P&L Color Coding === */

.pnl-positive {
    color: $success;
}

.pnl-negative {
    color: $error;
}

.pnl-neutral {
    color: $text-secondary;
}

/* === Button Group === */

.button-group {
    align-vertical: middle;
    height: 100%;
}

/* === Contextual Footer === */

ContextualFooter {
    dock: bottom;
    height: 1;
    background: $bg-secondary;
    border-top: double $accent;     /* Double border to match status bar */
}

#contextual-footer {
    height: 100%;
    align-vertical: middle;
    padding: 0 $spacing-md;
}

.footer-group {
    margin-right: $spacing-md;
    align-vertical: middle;
}

.footer-group-right {
    dock: right;
}

.footer-key {
    color: $bg-primary;
    text-style: bold;
    background: $accent;
    padding: 0 $spacing-md;
    margin-right: $spacing-xs;
}

.footer-label {
    color: $text-primary;
    margin-right: $spacing-md;  /* More spacing between groups */
}

.footer-separator {
    color: $border-subtle;
    margin: 0 $spacing-xs;
}

/* === Account Widget === */

AccountWidget {
    layout: vertical;
    padding: $spacing-xs;
    /* height controlled by widget DEFAULT_CSS */
}

.account-metric {
    background: $bg-elevated;
    border: solid $border-subtle;
    padding: $spacing-xs $spacing-md;
    margin: $spacing-xs;
    height: auto;
}

.account-metric-label {
    color: $text-secondary;
    text-style: bold;
}

.account-metric-value {
    color: $text-primary;
    text-style: bold;
    text-align: right;
}

.portfolio-summary-row {
    margin-bottom: $spacing-sm;
}

.portfolio-metric {
    background: $bg-elevated;
    border: solid $border-subtle;
    padding: $spacing-xs $spacing-md;
    margin: $spacing-xs;
}

.portfolio-metric-label {
    color: $text-secondary;
    text-style: bold;
}

.portfolio-metric-value {
    color: $text-primary;
    text-style: bold;
}

.account-metrics-row {
    margin-bottom: $spacing-sm;
}

/* === Block Chart Widget === */

BlockChartWidget {
    /* height controlled by widget DEFAULT_CSS */
    padding: 0 $spacing-xs;
    border-top: solid $border-subtle;
}

.chart-content {
    height: 3;
    color: $success;               /* Default to success color */
}

/* ========================================================================== */
/* ANIMATIONS & TRANSITIONS                                                   */
/* ========================================================================== */

/* Note: Textual has limited transition support
 * Animations are handled via Python update intervals
 */

/* === Loading Spinner === */

/* Note: Unicode Braille spinner (⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏) is animated via Python interval,
 * not CSS animations, for reliable terminal rendering.
 */

LoadingSpinner {
    width: auto;
    height: auto;
    align-horizontal: center;
    align-vertical: middle;
}

#spinner-display {
    color: $accent;
    text-style: bold;
    text-align: center;
}

.loading-spinner {
    color: $accent;
    text-style: bold;
    text-align: center;
}

.loading-message {
    color: $text-secondary;
    text-align: center;
    margin-top: $spacing-xs;
}

.loading-container {
    padding: $spacing-lg;
    background: rgba(58, 53, 48, 0.2);
    border: solid $border-subtle;
    align-horizontal: center;
    align-vertical: middle;
}

/* Note: Textual doesn't support @keyframes or @media queries
 * Advanced animations and media queries must be implemented in Python
 */
