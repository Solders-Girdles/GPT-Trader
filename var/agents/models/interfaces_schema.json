{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GPT-Trader Core Interfaces",
  "description": "Domain model schemas for trading operations",
  "definitions": {
    "Candle": {
      "title": "Candle",
      "type": "object",
      "properties": {
        "ts": {
          "type": "string",
          "format": "date-time",
          "description": "Candle timestamp (start of period)"
        },
        "open": {
          "type": "string",
          "format": "decimal",
          "description": "Opening price"
        },
        "high": {
          "type": "string",
          "format": "decimal",
          "description": "Highest price in period"
        },
        "low": {
          "type": "string",
          "format": "decimal",
          "description": "Lowest price in period"
        },
        "close": {
          "type": "string",
          "format": "decimal",
          "description": "Closing price"
        },
        "volume": {
          "type": "string",
          "format": "decimal",
          "description": "Trading volume in base asset"
        }
      },
      "required": [
        "ts",
        "open",
        "high",
        "low",
        "close",
        "volume"
      ],
      "description": "OHLCV price bar."
    },
    "Quote": {
      "title": "Quote",
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "description": "Trading symbol (e.g., BTC-USD)"
        },
        "bid": {
          "type": "string",
          "format": "decimal",
          "description": "Best bid price"
        },
        "ask": {
          "type": "string",
          "format": "decimal",
          "description": "Best ask price"
        },
        "last": {
          "type": "string",
          "format": "decimal",
          "description": "Last traded price"
        },
        "ts": {
          "type": "string",
          "format": "date-time",
          "description": "Quote timestamp"
        }
      },
      "required": [
        "symbol",
        "bid",
        "ask",
        "last",
        "ts"
      ],
      "description": "Current bid/ask/last price snapshot."
    },
    "Product": {
      "title": "Product",
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "description": "Trading symbol (e.g., BTC-USD)"
        },
        "base_asset": {
          "type": "string",
          "description": "Base asset (e.g., BTC)"
        },
        "quote_asset": {
          "type": "string",
          "description": "Quote asset (e.g., USD)"
        },
        "market_type": {
          "type": "string",
          "enum": [
            "SPOT",
            "FUTURE",
            "PERPETUAL",
            "FUTURES"
          ],
          "description": "Market type: SPOT, PERPETUAL, FUTURE"
        },
        "min_size": {
          "type": "string",
          "format": "decimal",
          "description": "Minimum order size in base asset"
        },
        "step_size": {
          "type": "string",
          "format": "decimal",
          "description": "Order size increment"
        },
        "min_notional": {
          "type": "string",
          "description": "Minimum order value in quote asset"
        },
        "price_increment": {
          "type": "string",
          "format": "decimal",
          "description": "Minimum price increment (tick size)"
        },
        "leverage_max": {
          "type": "string",
          "description": "Maximum leverage (null for spot)"
        },
        "expiry": {
          "type": "string",
          "description": "Contract expiry date (futures only)"
        },
        "contract_size": {
          "type": "string",
          "description": "Contract multiplier"
        },
        "funding_rate": {
          "type": "string",
          "description": "Current funding rate (perpetuals)"
        },
        "next_funding_time": {
          "type": "string",
          "description": "Next funding timestamp"
        }
      },
      "required": [
        "symbol",
        "base_asset",
        "quote_asset",
        "market_type",
        "min_size",
        "step_size",
        "min_notional",
        "price_increment",
        "leverage_max"
      ],
      "description": "Trading instrument specification."
    },
    "Order": {
      "title": "Order",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique order identifier from broker"
        },
        "symbol": {
          "type": "string",
          "description": "Trading symbol"
        },
        "side": {
          "type": "string",
          "enum": [
            "BUY",
            "SELL"
          ],
          "description": "Order side: BUY or SELL"
        },
        "type": {
          "type": "string",
          "enum": [
            "MARKET",
            "LIMIT",
            "STOP",
            "STOP_LIMIT"
          ],
          "description": "Order type: MARKET, LIMIT, STOP, STOP_LIMIT"
        },
        "quantity": {
          "type": "string",
          "format": "decimal",
          "description": "Order quantity in base asset"
        },
        "status": {
          "type": "string",
          "enum": [
            "PENDING",
            "SUBMITTED",
            "PARTIALLY_FILLED",
            "FILLED",
            "CANCELLED",
            "REJECTED",
            "EXPIRED",
            "FAILED"
          ],
          "description": "Order status: PENDING, SUBMITTED, FILLED, etc."
        },
        "filled_quantity": {
          "type": "string",
          "format": "decimal",
          "default": "0",
          "description": "Quantity already filled"
        },
        "price": {
          "type": "string",
          "description": "Limit price (null for market orders)"
        },
        "stop_price": {
          "type": "string",
          "description": "Stop trigger price"
        },
        "tif": {
          "type": "string",
          "enum": [
            "GTC",
            "IOC",
            "FOK"
          ],
          "default": "GTC",
          "description": "Time in force: GTC, IOC, FOK"
        },
        "client_id": {
          "type": "string",
          "description": "Client-provided order identifier"
        },
        "avg_fill_price": {
          "type": "string",
          "description": "Average fill price"
        },
        "submitted_at": {
          "type": "string",
          "description": "Order submission timestamp"
        },
        "updated_at": {
          "type": "string",
          "description": "Last update timestamp"
        },
        "created_at": {
          "type": "string",
          "description": "Creation timestamp"
        }
      },
      "required": [
        "id",
        "symbol",
        "side",
        "type",
        "quantity",
        "status"
      ],
      "description": "Trading order representation."
    },
    "Position": {
      "title": "Position",
      "type": "object",
      "properties": {
        "symbol": {
          "type": "string",
          "description": "Trading symbol"
        },
        "quantity": {
          "type": "string",
          "format": "decimal",
          "description": "Position size (positive for long, negative for short)"
        },
        "entry_price": {
          "type": "string",
          "format": "decimal",
          "description": "Average entry price"
        },
        "mark_price": {
          "type": "string",
          "format": "decimal",
          "description": "Current mark price"
        },
        "unrealized_pnl": {
          "type": "string",
          "format": "decimal",
          "description": "Unrealized profit/loss"
        },
        "realized_pnl": {
          "type": "string",
          "format": "decimal",
          "description": "Realized profit/loss"
        },
        "side": {
          "type": "string",
          "description": "Position side: long or short"
        },
        "leverage": {
          "type": "string",
          "description": "Current leverage"
        }
      },
      "required": [
        "symbol",
        "quantity",
        "entry_price",
        "mark_price",
        "unrealized_pnl",
        "realized_pnl",
        "side"
      ],
      "description": "Trading position representation."
    },
    "Balance": {
      "title": "Balance",
      "type": "object",
      "properties": {
        "asset": {
          "type": "string",
          "description": "Asset symbol (e.g., USD, BTC)"
        },
        "total": {
          "type": "string",
          "format": "decimal",
          "description": "Total balance"
        },
        "available": {
          "type": "string",
          "format": "decimal",
          "description": "Available balance (total - hold)"
        },
        "hold": {
          "type": "string",
          "format": "decimal",
          "default": "0",
          "description": "Amount on hold for open orders"
        }
      },
      "required": [
        "asset",
        "total",
        "available"
      ],
      "description": "Account balance for a single asset."
    }
  }
}
