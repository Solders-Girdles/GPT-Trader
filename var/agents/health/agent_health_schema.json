{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Agent Health Report",
  "type": "object",
  "required": [
    "schema_version",
    "tool",
    "generated_at",
    "status",
    "checks",
    "summary"
  ],
  "properties": {
    "schema_version": {
      "type": "string"
    },
    "tool": {
      "type": "object",
      "required": [
        "name",
        "version",
        "script"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "script": {
          "type": "string"
        }
      }
    },
    "generated_at": {
      "type": "string"
    },
    "profile": {
      "type": "string"
    },
    "status": {
      "type": "string",
      "enum": [
        "passed",
        "failed",
        "warning",
        "skipped"
      ]
    },
    "summary": {
      "type": "object",
      "properties": {
        "passed": {
          "type": "integer"
        },
        "failed": {
          "type": "integer"
        },
        "warning": {
          "type": "integer"
        },
        "skipped": {
          "type": "integer"
        }
      }
    },
    "checks": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "name",
          "status",
          "summary",
          "duration_seconds"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "passed",
              "failed",
              "warning",
              "skipped"
            ]
          },
          "summary": {
            "type": "string"
          },
          "duration_seconds": {
            "type": "number"
          },
          "details": {
            "type": "object"
          }
        }
      }
    },
    "ci_inputs": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "format": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "summary": {
            "type": "object",
            "properties": {
              "passed": {
                "type": "integer"
              },
              "failed": {
                "type": "integer"
              },
              "errors": {
                "type": "integer"
              },
              "skipped": {
                "type": "integer"
              },
              "total": {
                "type": "integer"
              },
              "duration_seconds": {
                "type": "number"
              }
            }
          },
          "error": {
            "type": "string"
          }
        }
      }
    },
    "test_summary": {
      "type": "object",
      "properties": {
        "passed": {
          "type": "integer"
        },
        "failed": {
          "type": "integer"
        },
        "errors": {
          "type": "integer"
        },
        "skipped": {
          "type": "integer"
        },
        "total": {
          "type": "integer"
        },
        "duration_seconds": {
          "type": "number"
        },
        "sources": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "source": {
                "type": "string"
              },
              "path": {
                "type": "string"
              },
              "format": {
                "type": "string"
              },
              "summary": {
                "type": "object",
                "properties": {
                  "passed": {
                    "type": "integer"
                  },
                  "failed": {
                    "type": "integer"
                  },
                  "errors": {
                    "type": "integer"
                  },
                  "skipped": {
                    "type": "integer"
                  },
                  "total": {
                    "type": "integer"
                  },
                  "duration_seconds": {
                    "type": "number"
                  }
                }
              }
            }
          }
        }
      }
    },
    "hints": {
      "type": "array",
      "items": {
        "type": "string"
      }
    }
  }
}
