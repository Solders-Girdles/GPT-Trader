[pytest]
# Python path configuration
pythonpath = src

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
norecursedirs = archived scripts

# Output and reporting
addopts =
    --verbose
    --tb=short
    --strict-config
    --strict-markers
    --durations=10
    --maxfail=10
    -p no:warnings
    -m "not integration and not real_api and not uses_mock_broker"

# Coverage configuration (when using --cov)
# Run with: pytest --cov=src --cov-report=term-missing --cov-report=json:coverage.json --cov-report=html:htmlcov
# Current baseline: 23.50% (as of 2025-10-19)
# Short-term goal: 40%
# Long-term goal: 80%

# Minimum version
minversion = 7.0

markers =
    endpoints: Coinbase API endpoint tests (paths/params/modes/errors)
    perf: Performance benchmarks (opt-in)
    performance: Performance benchmarks (alias to perf)
    slow: High-duration tests gated from default dev runs
    integration: Integration-level tests (skipped by default)
    perps: Perpetual futures trading tests
    real_api: Tests that hit real Coinbase APIs (opt-in)
    uses_mock_broker: Tests that depend on the deterministic broker (legacy MockBroker path; skipped by default)
    asyncio: Async tests (mapped to anyio via anyio plugin)
    anyio: Async tests using anyio
