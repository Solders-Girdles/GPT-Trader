# =============================================================================
# COINBASE PERPETUALS QUICK START
# =============================================================================
# Copy this file to .env and fill in your actual API credentials
# NEVER commit .env files with real credentials to git!
#
# Minimal setup options:
# - Paper mode (no credentials):
#     BROKER=coinbase
#     PERPS_PAPER=1
#
# - Production (real, Advanced Trade + JWT):
#     BROKER=coinbase
#     COINBASE_ENABLE_DERIVATIVES=1
#     COINBASE_API_MODE=advanced
#     COINBASE_SANDBOX=0
#     COINBASE_PROD_CDP_API_KEY=your_cdp_key_name
#     COINBASE_PROD_CDP_PRIVATE_KEY="""-----BEGIN EC PRIVATE KEY-----\n...\n-----END EC PRIVATE KEY-----"""

# =============================================================================
# ESSENTIAL CONFIGURATION ( ~10 variables )
# =============================================================================

# Core
BROKER=coinbase
PERPS_PAPER=0           # 1 to use safe mock mode (no creds)
LOG_LEVEL=INFO          # DEBUG/INFO/WARNING/ERROR
RISK_CONFIG_PATH=       # Optional: JSON risk config (e.g., config/risk/coinbase_perps.prod.json)

# Coinbase (production JWT)
COINBASE_API_MODE=advanced
COINBASE_SANDBOX=0      # Must be 0 for perps
COINBASE_ENABLE_DERIVATIVES=1
COINBASE_PROD_CDP_API_KEY=
COINBASE_PROD_CDP_PRIVATE_KEY=

# Coinbase (Exchange/HMAC for spot/dev)
# These keys are used for legacy Exchange API or non-derivatives smoke tests.
COINBASE_API_KEY=
COINBASE_API_SECRET=
COINBASE_API_PASSPHRASE=

# Order preview gating (Advanced/PROD)
# When enabled (1/true), place_order preflights with preview_order and fails closed on preview errors.
# Default: auto-enabled when api_mode=advanced, sandbox=0, derivatives=1 and auth_type=JWT
# ORDER_PREVIEW_ENABLED=

# Risk (sane defaults; override as needed)
RISK_MAX_LEVERAGE=5
RISK_MAX_EXPOSURE_PCT=0.80
RISK_MAX_POSITION_PCT_PER_SYMBOL=0.25
RISK_DAILY_LOSS_LIMIT=100
RISK_MAX_MARK_STALENESS_SECONDS=180
RISK_SLIPPAGE_GUARD_BPS=50
RISK_REDUCE_ONLY_MODE=0
RISK_KILL_SWITCH_ENABLED=0

# Per-symbol caps (optional)
# Format examples:
#   RISK_LEVERAGE_MAX_PER_SYMBOL=BTC-PERP:1,ETH-PERP:2
#   RISK_MAX_NOTIONAL_PER_SYMBOL=BTC-PERP:500,ETH-PERP:300
#   RISK_DAY_LEVERAGE_MAX_PER_SYMBOL=BTC-PERP:1
#   RISK_NIGHT_LEVERAGE_MAX_PER_SYMBOL=BTC-PERP:1
RISK_LEVERAGE_MAX_PER_SYMBOL=
RISK_MAX_NOTIONAL_PER_SYMBOL=

# Day/night schedule (optional)
# Apply stricter caps or MMR during certain UTC windows
RISK_DAYTIME_START_UTC=
RISK_DAYTIME_END_UTC=
# Example (10x window hours):
# RISK_DAYTIME_START_UTC=13:00
# RISK_DAYTIME_END_UTC=17:00
# RISK_DAY_LEVERAGE_MAX_PER_SYMBOL=BTC-PERP:10,ETH-PERP:10,SOL-PERP:10,XRP-PERP:10
# RISK_NIGHT_LEVERAGE_MAX_PER_SYMBOL=BTC-PERP:5,ETH-PERP:5,SOL-PERP:5,XRP-PERP:5
RISK_DAY_LEVERAGE_MAX_PER_SYMBOL=
RISK_NIGHT_LEVERAGE_MAX_PER_SYMBOL=
RISK_DAY_MMR_PER_SYMBOL=
RISK_NIGHT_MMR_PER_SYMBOL=

# Liquidation buffer projection (optional)
RISK_MIN_LIQUIDATION_BUFFER_PCT=0.15
RISK_ENABLE_PRE_TRADE_LIQ_PROJECTION=1
RISK_DEFAULT_MMR=0.005

# Volatility circuit breaker (optional)
RISK_ENABLE_VOLATILITY_CB=0
RISK_MAX_INTRADAY_VOL=0.15
RISK_VOL_WINDOW_PERIODS=20
RISK_CB_COOLDOWN_MIN=30
RISK_VOL_WARNING_THRESH=0.15
RISK_VOL_REDUCE_ONLY_THRESH=0.20
RISK_VOL_KILL_SWITCH_THRESH=0.25

# Streaming (Market Data Reliability)
# Enable background WS streaming for CANARY/PROD to update marks + staleness timestamps.
# Defaults: disabled. Use REST get_quote() fallback always.
# PERPS_ENABLE_STREAMING=0
# COINBASE_WS_USER_AUTH=0   # Enable JWT attach for WS user channel when using CDP/JWT auth
# PERPS_STREAM_LEVEL=1      # 1 for ticker, 2 for level2 orderbook

# Data Provider Configuration
# Control whether to use real Coinbase API data or mock data for backtesting
# COINBASE_USE_REAL_DATA=0  # 1 to use real Coinbase API data, 0 for mock data
# COINBASE_ENABLE_STREAMING=0  # 1 to enable WebSocket streaming (requires COINBASE_USE_REAL_DATA=1)
# COINBASE_DATA_CACHE_TTL=5  # Cache TTL in seconds for market data

# Symbols (if CLI --symbols not provided)
# Example: TRADING_SYMBOLS=BTC-PERP,ETH-PERP,SOL-PERP,XRP-PERP
TRADING_SYMBOLS=

# Fee model for sizing tools (optional)
# Default roundtrip fee in bps per symbol. Example: BTC-PERP:6,ETH-PERP:8,SOL-PERP:10,XRP-PERP:12
FEE_BPS_BY_SYMBOL=
