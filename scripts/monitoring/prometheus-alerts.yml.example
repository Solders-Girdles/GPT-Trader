groups:
  - name: coinbase_trader_alerts
    interval: 30s
    rules:
      - alert: CoinbaseTraderNoMetrics
        expr: time() - coinbase_trader_metrics_timestamp_seconds > 300
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "Coinbase Trader metrics stale"
          description: "No fresh cycle metrics received for over 5 minutes."

      - alert: CoinbaseTraderLowTradingLimit
        expr: coinbase_trader_account_limit_remaining < 1000
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Trading limit running low"
          description: "Remaining Coinbase trading limit is below $1,000."

      - alert: CoinbaseTraderPreviewFailures
        expr: increase(coinbase_trader_order_preview_failures_total[5m]) > 0
        labels:
          severity: warning
        annotations:
          summary: "Order preview failures detected"
          description: "Coinbase Trader encountered order preview errors in the last 5 minutes."
